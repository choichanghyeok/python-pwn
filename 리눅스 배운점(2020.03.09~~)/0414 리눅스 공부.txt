1. 네임서버 개념

네임 서버 >> DNS 서버

> 도메인 이름을 IP주소로 변환시켜 주는 역할
ex) www.nate.com >> 120.50.131.112


##가장 초기의 네트워크 접속 방법
> 컴퓨터가 몇 대 안 됨
> 사용자가 모두 외워서 직접 IP주소로 접근함.

##host 파일을 이용하여 네트워크 접속 (host파일에 URL과 IP주소를 기록해 놓는 방식을 사용)

윈도우 > c:\Windows\system32\drivers\etc\hosts

리눅스 > /etc/hosts

##네임서버를 이용하여 네트워크 접속
>기하급수적으로 늘어나는 네트워크 상의 컴퓨터에 대한 모든 IP 정보를 파일 하나에 기록하는것은 무리

이름해석을 전문적으로 해주는 서버 컴퓨터가 필요함.

URL만 알고 있으면 어디서든지 해당하는 컴퓨터에 접속가능


@@@
리눅스 터미널에

nslookup 을 입력하고 server을 입력하면 현 리눅스의 도메인 주소가 나온다.

또 www.nate.com 을 입력하면 네이트의 (도메인)서버 주소가 나온다.
(주소가 여러개 존재하는 이유는 다중사용자들 때문임)

리눅스의 네임서버를 알고싶다면 터미널에 
cat /etc/resolv.conf 를 입력하면 된다.

>> 만약 vi 나 편집기로 resolv.conf 의 도메인 주소를 수정하게되면 서버를 찾을수가 없어
네트워크 망은 정상이지만 물어볼 즉 알려줄 컴퓨터가 없으므로 네트워크에 접속할수 없다.

따라서 이런식으로 도메인주소도 변경이가능하다.

또 vi 나 편집기로 /etc/hosts 의 파일의 주소를 변경하면 다른 사이트가 나올수있다. 

즉 원래 네이버가 1이고 다음이 2라면 hosts에서

네이버의 1을 2로 바꾸고 다음을 1로 바꾼다면

네이버를 입력했을때 다음홈페이지가 나오게된다.

(즉 웹브라우저는 접속만 시켜주고 검증을 할수있는 능력은 없다)


IP주소를 얻는 내부 흐름

URL 입력 >> /etc/host.conf 조회 >> /etc/hosts >> 존재한다면 >> IP 주소 획득 

URL 입력 >> /etc/host.conf 조회 >> /etc/hosts >> 존재하지 않는다면 >> /etc/resolv.conf >> 네임서버 설정 없음 >> 호스트 이름 알수없음 >> 응답없음

URL 입력 >> /etc/host.conf 조회 >> /etc/hosts >> 존재하지 않는다면 >> /etc/resolv.conf >> 네임서버 설정 존재 >> 질의 >> 응답





@@@ 도메인 이름 체계 @@@

초창기 인터넷에서는 1대의 네임서버만으로도 충분히 IP주소와 이름의 관리가 가능

하지만 인터넷이 많아져서 관리가 어려워 트리구조와 같은 도메인 이름 체계를 고안함.


로컬 네임 서버가 작동하는 순서

pc가 사용하는 네임 서버가 /etc/resolv.conf 파일에 "nameserver IP 주소" 로 설정되어 있는데, 이 네임 서버를 로컬 네임 서버라고 부름.

www.nate.com 의 IP주소를 요구하면 이 로컬네임서버에 질문함.


캐시 전용 네임 서버

>> PC에서 URL로 IP주소를 얻고자 할 떄, 해당하는 URL의 IP주소를 알려주는 네임서버를 말함


네임서버 설치하는법

apt-get -y install bind9 bind9utils 입력

vi /etc/bind/named.conf.options 로 열어서

(3행에 recursion yes; allow-query { any; }; 이 두줄을 추가하고 저장)

systemctl restart bind9
systemctl enable bind9

systemctl status bind9 로 작동하는지 확인

ufw allow 53/tcp

ufw status	>> 현재 열린 방화벽을 확인이 가능함

dig @ 192.168.111.100 www.nate.com

(신호가 가는지 확인)

or nalookup 명령어로도 가능
ex) server 192.168.111.100 입력 후 www.nate.com 입력

이런식으로 네임서버를 구축이 가능하다.





$$$$$ 마스터 네임서버 구축 $$$$$

>> 도메인에 속해 있는 컴퓨터들의 이름을 관리하고, 외부에 해당 컴퓨터의 IP주소를 알려주는 역할

@웹서버를 설치

apt-get -y install apache2 설치

systemctl restart apache2
systemctl enable apache2
systemctl status apache2

ufw allow 80/tcp

cd /var/www/html/	>> 웹서버의 홈디렉터리

/var/www/html 에 기존에 있던 rm index.html 을 지우고

index.html을 새로 만든다.

내용은 ( 아무렇게나 ex) Ubuntu 16.04 LTS. web Server </h1> )저장	>> 간단하게 웹서버를 만들었음


잘작동하는지 확인하기 위해


@@
그리고 서버B에 apt-get -y install vsftpd 설치

cd /srv/ftp 들어가서 touch welcom.msg 만들고
vi로 아무글이나 써넣는다.

vi /etc/vsftpd.conf 입력

(25행 의 = 에 yes를 적어준다) 그리고 아랫줄에 banner_file=/srv/ftp/welcome.msg 를 입력


systemctl restart vsftpd

(결론적으로 웹서버를 만드는법)
(나머지 부분은 구글에 마스터 네임서버 구축법 검색)



@@@ 라운드 로빈 방식의 네임서버 @@@
>여러대의 웹서버를 운영해서 웹 클라이언트가 서비스를 요청할 경우 교대로 서비스를 실시하도록 하는 방식

(구글 검색 라운드 로빈방식 네임서버 구축방법)

